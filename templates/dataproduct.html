{% extends base.html %}

{% block title %}
  Dispatch Directions  
{% end %}

{% block local_css %}
  <style type="text/css">
    html { height: 100% }
    body { height: 100%; margin: 0px; padding: 0px }
    #map_canvas { 
      width: 85%;
      height: 85%;
      margin-left: auto;
      margin-right: auto;}
  </style>
{% end %}

{% block local_js %}
  <script type="text/javascript"
      src="http://maps.google.com/maps/api/js?sensor=false">
  </script>
  <script type="text/javascript"
      src="{{ static_url("underscore/underscore.js") }}">
  </script>
  <script type="text/javascript">

    var directionsDisplay;
    var directionsService = new google.maps.DirectionsService();
    var map;

    function initialize() {
      // TODO: chooser for start fire station (or maybe change dynamically
      // based on sources
      var seattle = new google.maps.LatLng(47.629, -122.330);

      var mapOptions = {
        zoom: 11,
        center: seattle,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
      };

      var map = new google.maps.Map(document.getElementById("map_canvas"),
          mapOptions);
      directionsDisplay = new google.maps.DirectionsRenderer();
      directionsDisplay.setMap(map);

      var request = {
        origin: "Seattle, WA",
        destination: "Bellevue, WA",
        waypoints: [
          {
            location:"Shoreline, WA", 
            stopover:true
          },{
            location:"Kirkland, WA",
            stopover:true
          }],
        provideRouteAlternatives: false,
        travelMode: google.maps.DirectionsTravelMode.DRIVING,
        unitSystem: google.maps.DirectionsUnitSystem.IMPERIAL
      }

      directionsService.route(request, function(result, status) {
         if (status == google.maps.DirectionsStatus.OK) {
           directionsDisplay.setDirections(result);
         }
         else {
           console.log(status);
         }
      });
    }

  </script>
{% end %}

{% block content %}
  <body onload="initialize()">
    <h1>Dispatch Directions</h1>
    <div id="map_canvas"></div>
  </body>
{% end %}
